{"remainingRequest":"/home/tmst/an3sem2/sd/final-project-luaRRaul/stockhelt/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/tmst/an3sem2/sd/final-project-luaRRaul/stockhelt/frontend/src/components/DoctorTextDialog.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/tmst/an3sem2/sd/final-project-luaRRaul/stockhelt/frontend/src/components/DoctorTextDialog.vue","mtime":1622559851642},{"path":"/home/tmst/an3sem2/sd/final-project-luaRRaul/stockhelt/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/tmst/an3sem2/sd/final-project-luaRRaul/stockhelt/frontend/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/tmst/an3sem2/sd/final-project-luaRRaul/stockhelt/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/tmst/an3sem2/sd/final-project-luaRRaul/stockhelt/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBTb2NrSlMgZnJvbSAic29ja2pzLWNsaWVudCI7CmltcG9ydCBTdG9tcCBmcm9tICJ3ZWJzdG9tcC1jbGllbnQiOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJEb2N0b3JUZXh0RGlhbG9nIiwKICBkYXRhKCl7CiAgICByZXR1cm4gewogICAgICBzZW5kX21lc3NhZ2U6IG51bGwsCiAgICAgIGNvbm5lY3RlZDogZmFsc2UsCiAgICAgIC8vIHJvbGVzOiBbIlNlY3JldGFyeSIsICJEb2N0b3IiLCAiQWRtaW4iXSwKICAgIH0KICB9LAogIHByb3BzOiB7CiAgICBwYXRpZW50OiBPYmplY3QsCiAgICBvcGVuZWQ6IEJvb2xlYW4sCiAgfSwKICBtZXRob2RzOiB7CiAgICBzZW5kKCkgewogICAgICBjb25zb2xlLmxvZygiU2VuZCBtZXNzYWdlOiIgKyB0aGlzLnNlbmRfbWVzc2FnZSk7CiAgICAgIGlmICh0aGlzLnN0b21wQ2xpZW50ICYmIHRoaXMuc3RvbXBDbGllbnQuY29ubmVjdGVkKSB7CiAgICAgICAgdGhpcy5zZW5kX21lc3NhZ2UgPSB7CiAgICAgICAgICB0eXBlIDogIk1TRyIsCiAgICAgICAgICBjb250ZW50OiAiSGVsbG93IFdvcmxkISIsCiAgICAgICAgICBzZW5kZXI6IHRoaXMuJHN0b3JlLnN0YXRlLmF1dGgudXNlci5pZAogICAgICAgIH07CiAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkodGhpcy5zZW5kX21lc3NhZ2UpKTsKICAgICAgICB0aGlzLnN0b21wQ2xpZW50LnNlbmQoIi9hcGkvY2hhdC90b3BpYy8iK3RoaXMucGF0aWVudC5pZCwgSlNPTi5zdHJpbmdpZnkodGhpcy5zZW5kX21lc3NhZ2UpLHt9KTsKICAgICAgfQogICAgfSwKICAgIGNvbm5lY3QoKSB7CiAgICAgIHRoaXMuc29ja2V0ID0gbmV3IFNvY2tKUygiaHR0cDovL2xvY2FsaG9zdDo4MDg4L2FwaS9teS13ZWJzb2NrZXQiKTsKICAgICAgdGhpcy5zdG9tcENsaWVudCA9IFN0b21wLm92ZXIodGhpcy5zb2NrZXQpOwogICAgICB0aGlzLnN0b21wQ2xpZW50LmNvbm5lY3QoCiAgICAgICAgICB7fSwKICAgICAgICAgIGZyYW1lID0+IHsKICAgICAgICAgICAgdGhpcy5jb25uZWN0ZWQgPSB0cnVlOwogICAgICAgICAgICBjb25zb2xlLmxvZyhmcmFtZSk7CiAgICAgICAgICAgIHRoaXMuc3RvbXBDbGllbnQuc3Vic2NyaWJlKCIvYXBpL3RvcGljL21lc3NhZ2VzLyIrdGhpcy4kc3RvcmUuc3RhdGUuYXV0aC51c2VyLmlkLGZ1bmN0aW9uIChyZXNwb25zZSl7CiAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpOwogICAgICAgICAgICAgIGxldCBkYXRhID0gSlNPTi5wYXJzZShyZXNwb25zZS5ib2R5KTsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9LAogICAgICAgICAgZXJyb3IgPT4gewogICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7CiAgICAgICAgICAgIHRoaXMuY29ubmVjdGVkID0gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICk7CiAgICB9LAogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGlzTmV3OiBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiAhdGhpcy5wYXRpZW50LmlkOwogICAgfSwKICB9LAogIHdhdGNoOnsKICAgIG9wZW5lZDogYXN5bmMgZnVuY3Rpb24gKG5ld1ZhbCwgb2xkVmFsKSB7CiAgICAgIGlmIChuZXdWYWwgJiYgIW9sZFZhbCkgewogICAgICAgIHRoaXMuY29ubmVjdCgpOwogICAgICB9CiAgICB9CiAgfSwKfTsK"},{"version":3,"sources":["DoctorTextDialog.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAiBA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"DoctorTextDialog.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <v-dialog\n      transition=\"dialog-bottom-transition\"\n      max-width=\"600\"\n      :value=\"opened\"\n  >\n    <template>\n      <v-card>\n          <v-btn @click=\"send\">\n            Send\n          </v-btn>\n      </v-card>\n    </template>\n  </v-dialog>\n</template>\n\n<script>\nimport SockJS from \"sockjs-client\";\nimport Stomp from \"webstomp-client\";\n\nexport default {\n  name: \"DoctorTextDialog\",\n  data(){\n    return {\n      send_message: null,\n      connected: false,\n      // roles: [\"Secretary\", \"Doctor\", \"Admin\"],\n    }\n  },\n  props: {\n    patient: Object,\n    opened: Boolean,\n  },\n  methods: {\n    send() {\n      console.log(\"Send message:\" + this.send_message);\n      if (this.stompClient && this.stompClient.connected) {\n        this.send_message = {\n          type : \"MSG\",\n          content: \"Hellow World!\",\n          sender: this.$store.state.auth.user.id\n        };\n        console.log(JSON.stringify(this.send_message));\n        this.stompClient.send(\"/api/chat/topic/\"+this.patient.id, JSON.stringify(this.send_message),{});\n      }\n    },\n    connect() {\n      this.socket = new SockJS(\"http://localhost:8088/api/my-websocket\");\n      this.stompClient = Stomp.over(this.socket);\n      this.stompClient.connect(\n          {},\n          frame => {\n            this.connected = true;\n            console.log(frame);\n            this.stompClient.subscribe(\"/api/topic/messages/\"+this.$store.state.auth.user.id,function (response){\n              console.log(response);\n              let data = JSON.parse(response.body);\n              console.log(data);\n            });\n          },\n          error => {\n            console.log(error);\n            this.connected = false;\n          }\n      );\n    },\n  },\n  computed: {\n    isNew: function () {\n      return !this.patient.id;\n    },\n  },\n  watch:{\n    opened: async function (newVal, oldVal) {\n      if (newVal && !oldVal) {\n        this.connect();\n      }\n    }\n  },\n};\n</script>\n\n<style scoped></style>\n"]}]}